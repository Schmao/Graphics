<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Predictive Maintenance Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/prop-types@15/prop-types.min.js" crossorigin></script>
  <script src="https://unpkg.com/recharts@2.10.1/umd/Recharts.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-900">
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState } = React;
    const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } = Recharts;

    // Generate realistic data matching the reference image pattern
    const generateChartData = () => {
      const data = [];
      const baseTime = new Date('2024-09-24T13:28:00');
      
      // Helper function to create a spike shape
      const spikeShape = (pos) => {
        if (pos < 0.3) return pos / 0.3;
        if (pos < 0.5) return 1;
        return Math.max(0, 1 - (pos - 0.5) / 0.5);
      };
      
      for (let i = 0; i <= 60; i += 1) {
        const time = new Date(baseTime.getTime() + i * 60000);
        const timeStr = time.toTimeString().slice(0, 5);
        
        let cycleMultiplier = 0;
        
        // Phase 1: 5 quick spikes from 0-28 mins (13:28 to 13:56)
        if (i < 28) {
          const cycleLength = 5.5;
          const cyclePos = (i % cycleLength) / cycleLength;
          cycleMultiplier = spikeShape(cyclePos);
          const spikeNum = Math.floor(i / cycleLength);
          cycleMultiplier *= [0.95, 1.0, 0.9, 1.05, 0.92][spikeNum] || 1;
        }
        // Phase 2: Flat/low period from 28-42 mins (13:56 to 14:10)
        else if (i < 42) {
          cycleMultiplier = 0.08 + Math.sin(i * 0.5) * 0.05;
        }
        // Phase 3: 3 more spaced spikes from 42-60 mins (14:10 to 14:28)
        else {
          const phaseStart = 42;
          const cycleLength = 6;
          const cyclePos = ((i - phaseStart) % cycleLength) / cycleLength;
          cycleMultiplier = spikeShape(cyclePos);
          const spikeNum = Math.floor((i - phaseStart) / cycleLength);
          cycleMultiplier *= [1.0, 0.95, 1.02][spikeNum] || 1;
        }
        
        const noise = () => (Math.random() - 0.5) * 4;
        
        data.push({
          time: timeStr,
          capHeat: 45 + cycleMultiplier * 265 + noise(),
          capCool: 25 + cycleMultiplier * 165 + noise(),
          powerInput: 5 + cycleMultiplier * 50 + noise() * 0.5,
          seiCool: 24 + cycleMultiplier * 6 + noise() * 0.3,
          copHeat: 30 + cycleMultiplier * 37 + noise() * 0.5,
          copCool: 22 + cycleMultiplier * 30 + noise() * 0.5,
          refEvap: 1.5 + cycleMultiplier * 3 + noise() * 0.2,
          refCond: 25 + cycleMultiplier * 27 + noise() * 0.3,
          compEff: 35 + cycleMultiplier * 35 + noise() * 0.3,
        });
      }
      return data;
    };

    const chartData = generateChartData();

    // Semi-circular Gauge Component
    const Gauge = ({ value, maxValue = 100, size = 140, title, showLabels = true }) => {
      const percentage = Math.min(Math.max(value / maxValue, 0), 1);
      const angle = percentage * 180;
      const strokeWidth = size * 0.14;
      const radius = (size - strokeWidth) / 2;
      const centerX = size / 2;
      const centerY = size / 2 + 10;
      
      const getColor = (val) => {
        if (val < 20) return '#D63031';
        if (val < 40) return '#E17055';
        if (val < 60) return '#FDCB6E';
        if (val < 80) return '#55EFC4';
        return '#00B894';
      };
      
      const createArc = (startAngle, endAngle, r) => {
        const start = (startAngle - 180) * Math.PI / 180;
        const end = (endAngle - 180) * Math.PI / 180;
        const x1 = centerX + r * Math.cos(start);
        const y1 = centerY + r * Math.sin(start);
        const x2 = centerX + r * Math.cos(end);
        const y2 = centerY + r * Math.sin(end);
        const largeArc = endAngle - startAngle > 180 ? 1 : 0;
        return `M ${x1} ${y1} A ${r} ${r} 0 ${largeArc} 1 ${x2} ${y2}`;
      };
      
      const needleAngle = (angle - 180) * Math.PI / 180;
      const needleLength = radius - 8;
      const needleX = centerX + needleLength * Math.cos(needleAngle);
      const needleY = centerY + needleLength * Math.sin(needleAngle);
      
      return (
        <div className="flex flex-col items-center">
          <svg width={size} height={size * 0.65} viewBox={`0 0 ${size} ${size * 0.65}`}>
            <path d={createArc(0, 36, radius)} fill="none" stroke="#D63031" strokeWidth={strokeWidth} opacity="0.3" />
            <path d={createArc(36, 72, radius)} fill="none" stroke="#E17055" strokeWidth={strokeWidth} opacity="0.3" />
            <path d={createArc(72, 108, radius)} fill="none" stroke="#FDCB6E" strokeWidth={strokeWidth} opacity="0.3" />
            <path d={createArc(108, 144, radius)} fill="none" stroke="#55EFC4" strokeWidth={strokeWidth} opacity="0.3" />
            <path d={createArc(144, 180, radius)} fill="none" stroke="#00B894" strokeWidth={strokeWidth} opacity="0.3" />
            <path d={createArc(0, angle, radius)} fill="none" stroke={getColor(value)} strokeWidth={strokeWidth} />
            <line x1={centerX} y1={centerY} x2={needleX} y2={needleY} stroke="#E5E7EB" strokeWidth="2" strokeLinecap="round" />
            <circle cx={centerX} cy={centerY} r="4" fill="#E5E7EB" />
            {showLabels && [0, 20, 40, 60, 80, 100].map((label, i) => {
              const labelAngle = (label / 100 * 180 - 180) * Math.PI / 180;
              const labelRadius = radius + 14;
              const x = centerX + labelRadius * Math.cos(labelAngle);
              const y = centerY + labelRadius * Math.sin(labelAngle);
              return <text key={i} x={x} y={y} textAnchor="middle" fontSize="8" fill="#9CA3AF">{label}</text>;
            })}
          </svg>
          {title && <div className="text-xs font-semibold text-gray-300 mt-1">{title}</div>}
          <div className="text-lg font-bold" style={{ color: getColor(value) }}>{value.toFixed(1)}%</div>
        </div>
      );
    };

    // Metric Row Component
    const MetricRow = ({ label, value, unit = '' }) => (
      <div className="flex justify-between py-0.5 text-xs border-b border-gray-700 last:border-0">
        <span className="text-gray-400">{label}</span>
        <span className="text-gray-200 font-medium" style={{ fontVariantNumeric: 'tabular-nums' }}>{value} {unit}</span>
      </div>
    );

    // System Info Field Component
    const InfoField = ({ label, value }) => (
      <div className="flex justify-between py-1.5 border-b border-gray-700">
        <span className="text-xs text-gray-400">{label}</span>
        <span className="text-xs text-gray-200 font-medium">{value || '—'}</span>
      </div>
    );

    // Legend Item Component
    const LegendItem = ({ color, label }) => (
      <div className="flex items-center gap-1.5 text-xs text-gray-300">
        <div className="w-2 h-2 rounded-full" style={{ backgroundColor: color }}></div>
        <span>{label}</span>
      </div>
    );

    // Main Dashboard Component
    function PredictiveMaintenanceDashboard() {
      const [selectedTime] = useState('2024-09-24 14:27');
      
      return (
        <div className="min-h-screen bg-gray-900 flex">
          {/* Left Sidebar - System Information */}
          <div className="w-72 bg-gray-800 border-r border-gray-700 shadow-lg flex-shrink-0">
            <div className="p-4 border-b border-gray-700">
              <h2 className="font-bold text-gray-100">System Information</h2>
            </div>
            <div className="p-4 space-y-0">
              <InfoField label="Plant:" value="Shell - HK Oil Depot Admin" />
              <InfoField label="Paid:" value="008751#1" />
              <InfoField label="Customer:" value="RTenergy Limited" />
              <InfoField label="Unit Name:" value="ACC-03" />
              <InfoField label="Manufacturer:" value="Trane" />
              <InfoField label="Unit Model:" value="RTAC140H" />
              <InfoField label="Comp. Manufacturer:" value="" />
              <InfoField label="Comp. Model:" value="" />
              <InfoField label="Swept Volume:" value="" />
              <InfoField label="Evap. Manufacturer:" value="" />
              <InfoField label="Evap. Model:" value="" />
              <InfoField label="Cond. Model:" value="" />
              <InfoField label="Exp. Valve Manufacturer:" value="" />
              <InfoField label="Refrigerant:" value="R134A" />
              <InfoField label="Last time in operation:" value="2024-09-24 14:28" />
              <InfoField label="Values shown for:" value={selectedTime} />
            </div>
          </div>
          
          {/* Main Content Area */}
          <div className="flex-1 p-4 overflow-auto">
            {/* Time Series Chart */}
            <div className="bg-gray-800 rounded-lg shadow-lg p-4 mb-4">
              <h3 className="font-bold text-gray-100 mb-3">The hour before selected time</h3>
              <div className="flex">
                <div className="flex-1" style={{ height: 250 }}>
                  <ResponsiveContainer width="100%" height="100%">
                    <LineChart data={chartData} margin={{ top: 5, right: 5, left: 0, bottom: 5 }}>
                      <CartesianGrid strokeDasharray="3 3" stroke="#374151" />
                      <XAxis dataKey="time" tick={{ fontSize: 10, fill: '#9CA3AF' }} stroke="#4B5563" />
                      <YAxis yAxisId="left" tick={{ fontSize: 10, fill: '#9CA3AF' }} stroke="#4B5563" domain={[0, 350]} />
                      <YAxis yAxisId="right" orientation="right" tick={{ fontSize: 10, fill: '#9CA3AF' }} stroke="#4B5563" domain={[0, 80]} />
                      <Tooltip contentStyle={{ fontSize: 11, backgroundColor: '#1F2937', border: '1px solid #374151', color: '#E5E7EB' }} />
                      <Line yAxisId="left" type="monotone" dataKey="capHeat" stroke="#D63031" strokeWidth={2} dot={false} name="Cap. Heat kW" />
                      <Line yAxisId="left" type="monotone" dataKey="capCool" stroke="#0984E3" strokeWidth={2} dot={false} name="Cap. Cool kW" />
                      <Line yAxisId="left" type="monotone" dataKey="powerInput" stroke="#9CA3AF" strokeWidth={2} dot={false} name="Power input Comp. kW" />
                      <Line yAxisId="right" type="monotone" dataKey="seiCool" stroke="#00B894" strokeWidth={2} dot={false} name="SEI 1 Cool %" />
                      <Line yAxisId="right" type="monotone" dataKey="copHeat" stroke="#A29BFE" strokeWidth={2} dot={false} name="COP Heat Ref." />
                      <Line yAxisId="right" type="monotone" dataKey="copCool" stroke="#00CEC9" strokeWidth={2} dot={false} name="COP Cool Ref." />
                      <Line yAxisId="right" type="monotone" dataKey="refEvap" stroke="#FD79A8" strokeWidth={2} dot={false} name="Ref Evap. °C" />
                      <Line yAxisId="right" type="monotone" dataKey="refCond" stroke="#FDCB6E" strokeWidth={2} dot={false} name="Ref Cond. °C" />
                      <Line yAxisId="right" type="monotone" dataKey="compEff" stroke="#DFE6E9" strokeWidth={2} dot={false} name="Comp Eff Isen. %" />
                    </LineChart>
                  </ResponsiveContainer>
                </div>
                {/* Legend */}
                <div className="w-36 pl-3 space-y-1.5 flex flex-col justify-center">
                  <LegendItem color="#D63031" label="Cap. Heat kW" />
                  <LegendItem color="#0984E3" label="Cap. Cool kW" />
                  <LegendItem color="#9CA3AF" label="Power input Comp. kW" />
                  <LegendItem color="#00B894" label="SEI 1 Cool %" />
                  <LegendItem color="#A29BFE" label="COP Heat Ref." />
                  <LegendItem color="#00CEC9" label="COP Cool Ref." />
                  <LegendItem color="#FD79A8" label="Ref Evap. °C" />
                  <LegendItem color="#FDCB6E" label="Ref Cond. °C" />
                  <LegendItem color="#DFE6E9" label="Comp Eff Isen. %" />
                </div>
              </div>
            </div>
            
            {/* Bottom Section - SEI and Sub-Efficiencies */}
            <div className="flex gap-4">
              {/* System Efficiency Index */}
              <div className="bg-gray-800 rounded-lg shadow-lg p-4 w-64">
                <h3 className="font-bold text-gray-100 mb-2 text-sm">System Efficiency Index</h3>
                <div className="flex flex-col items-center">
                  <Gauge value={27.4} size={160} title="SEI Cool" />
                </div>
                <div className="mt-3 space-y-0">
                  <MetricRow label="SEI 1 Cool" value="27.4" unit="%" />
                  <MetricRow label="Ref Temp. Heat" value="32.1" unit="°C" />
                  <MetricRow label="Ref Temp. Cool" value="8.9" unit="°C" />
                  <MetricRow label="COP Heat Ref." value="4.58" />
                  <MetricRow label="COP Cool Ref." value="3.34" />
                  <MetricRow label="Cap. Heat" value="235.9" unit="kW" />
                  <MetricRow label="Cap. Cool" value="172" unit="kW" />
                  <MetricRow label="Rel. Power Comp. / Nom." value="" />
                  <MetricRow label="Power input Comp." value="51.5" unit="kW" />
                </div>
              </div>
              
              {/* Sub-Efficiencies */}
              <div className="flex-1 bg-gray-800 rounded-lg shadow-lg p-4">
                <h3 className="font-bold text-gray-100 mb-3 text-sm">Sub-Efficiencies</h3>
                <div className="grid grid-cols-4 gap-3">
                  {/* Refrigerant Cycle */}
                  <div className="border border-gray-700 rounded-lg p-2 bg-gray-850">
                    <Gauge value={91.8} size={110} title="Refrigerant Cycle n1" showLabels={false} />
                    <div className="mt-2 space-y-0 text-xs">
                      <MetricRow label="Eff Refr. Cycle" value="91.8" unit="%" />
                      <MetricRow label="Ref Evap." value="3.5" unit="°C" />
                      <MetricRow label="Ref Cond." value="49.3" unit="°C" />
                      <MetricRow label="Super-heat" value="5.2" unit="K" />
                      <MetricRow label="Sub-cool tot." value="17.8" unit="K" />
                      <MetricRow label="Press. Ratio" value="3.89" />
                    </div>
                  </div>
                  
                  {/* Compressor */}
                  <div className="border border-gray-700 rounded-lg p-2 bg-gray-850">
                    <Gauge value={67.7} size={110} title="Compressor n2" showLabels={false} />
                    <div className="mt-2 space-y-0 text-xs">
                      <MetricRow label="Comp Eff Isen." value="67.7" unit="%" />
                      <MetricRow label="Ref Evap." value="3.5" unit="°C" />
                      <MetricRow label="Ref Cond." value="49.3" unit="°C" />
                      <MetricRow label="Press. Ratio" value="3.89" />
                      <MetricRow label="Ref Comp. out" value="63.1" unit="°C" />
                      <MetricRow label="Super-heat" value="5.2" unit="K" />
                      <MetricRow label="Power input Comp." value="51.5" unit="kW" />
                      <MetricRow label="Comp. Heat loss" value="7" unit="%" />
                    </div>
                  </div>
                  
                  {/* Condenser */}
                  <div className="border border-gray-700 rounded-lg p-2 bg-gray-850">
                    <Gauge value={62.3} size={110} title="Condenser n4co" showLabels={false} />
                    <div className="mt-2 space-y-0 text-xs">
                      <MetricRow label="Eff 4 Cond." value="62.3" unit="%" />
                      <MetricRow label="Cap. Heat Cond" value="235.9" unit="kW" />
                      <MetricRow label="SecW Cond in" value="27.1" unit="°C" />
                      <MetricRow label="SecW Cond out" value="0" unit="°C" />
                      <MetricRow label="dt Cond. SecW out-in" value="-27.1" unit="°C" />
                      <MetricRow label="SecW Flow" value="-2.08" />
                      <MetricRow label="Ref Cond." value="49.3" unit="°C" />
                      <MetricRow label="Appro. Cond.-SecW in" value="22.2" unit="°C" />
                      <MetricRow label="Sub-cool Cond." value="49.3" unit="K" />
                      <MetricRow label="Sub-cool tot." value="17.8" unit="K" />
                    </div>
                  </div>
                  
                  {/* Evaporator */}
                  <div className="border border-gray-700 rounded-lg p-2 bg-gray-850">
                    <Gauge value={86.6} size={110} title="Evaporator n4ev" showLabels={false} />
                    <div className="mt-2 space-y-0 text-xs">
                      <MetricRow label="Eff 4 Evap." value="86.6" unit="%" />
                      <MetricRow label="Cap. Cool net" value="172.04" />
                      <MetricRow label="SecC Evap in" value="10.5" unit="°C" />
                      <MetricRow label="SecC Evap out" value="7.4" unit="°C" />
                      <MetricRow label="dt Evap. SecC in-out" value="3.1" unit="°C" />
                      <MetricRow label="SecC Flow" value="13.24" />
                      <MetricRow label="Ref Evap." value="3.5" unit="°C" />
                      <MetricRow label="Appro. SecC out-Evap." value="3.8" unit="°C" />
                      <MetricRow label="Ref Comp. in" value="8.8" unit="°C" />
                      <MetricRow label="Super heat evap." value="-3.5" unit="K" />
                      <MetricRow label="Super-heat" value="5.2" unit="K" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<PredictiveMaintenanceDashboard />);
  </script>
</body>
</html>
