<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gaiamesh™ Building Energy Health Check</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* ============================================
           CORE STYLES (aligned with D1/D2 reports)
           ============================================ */
        :root {
            /* Primary palette (matching report) */
            --primary: #1a365d;
            --secondary: #2c5282;
            --accent: #3182ce;
            --light-bg: #f7fafc;
            --border: #e2e8f0;
            --text: #2d3748;
            --muted: #718096;
            
            /* Status colors */
            --success: #276749;
            --warning: #c05621;
            --danger: #c53030;
            --info: #2b6cb0;
            
            /* Gaiamesh brand */
            --gaia-teal: #2E86AB;
            --gaia-coral: #E76F51;
        }
        
        * { 
            box-sizing: border-box; 
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 11pt;
            line-height: 1.5;
            color: var(--text);
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            min-height: 100vh;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        .slide-in {
            animation: slideIn 0.3s ease-out forwards;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
    const { useState, useCallback, useMemo, useEffect } = React;

    // ============================================
    // DATA OPTIONS (from Excel files)
    // ============================================
    const DATA_OPTIONS = {
        regions: ['China Mainland', 'Hong Kong', 'Singapore', 'Thailand', 'United States', 'Europe'],
        buildingTypes: [
            'Standalone Office',
            'Higher Education',
            'Landlords / Property Owners',
            'Office Tenants',
            'Retail',
            'Shopping Mall',
            'Industrial',
            'Data Center',
            'Hotel / Hospitality',
            'Healthcare'
        ],
        thermalSources: ['District, Building', 'District', 'Building', 'Split System', 'VRF/VRV'],
        useTypes: ['office', 'education', 'retail', 'industrial', 'mixed-use', 'residential', 'laboratory'],
        holidaySchedules: ['China Public Holidays', 'Hong Kong Public Holidays', 'US Federal Holidays', 'Custom'],
        equipmentTypes: [
            'Chiller',
            'Boiler',
            'Cooling Tower',
            'AHU (Air Handling Unit)',
            'FCU (Fan Coil Unit)',
            'VRF/VRV Indoor Unit',
            'VRF/VRV Outdoor Unit',
            'Split AC',
            'PAU (Primary Air Unit)',
            'Pump - Chilled Water',
            'Pump - Hot Water',
            'Pump - Condenser Water',
            'Lighting Panel',
            'Power Meter',
            'BMS Controller'
        ],
        utilityTypes: ['Electricity', 'Natural Gas', 'District Cooling', 'District Heating', 'Water', 'Steam'],
        cities: ['Shanghai', 'Beijing', 'Hong Kong', 'Singapore', 'Bangkok', 'San Francisco', 'Lisbon']
    };

    // Sample clients from Excel
    const SAMPLE_CLIENTS = [
        'M&G', 'East China Normal University', 'Jiachun Group', 'Noah Holdings',
        'Starbucks', 'JLL', 'Wanda', 'NYU Shanghai'
    ];

    // ============================================
    // ICON COMPONENTS
    // ============================================
    const Icons = {
        Building: () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect>
                <path d="M9 22v-4h6v4"></path>
                <path d="M8 6h.01"></path>
                <path d="M16 6h.01"></path>
                <path d="M12 6h.01"></path>
                <path d="M12 10h.01"></path>
                <path d="M12 14h.01"></path>
                <path d="M16 10h.01"></path>
                <path d="M16 14h.01"></path>
                <path d="M8 10h.01"></path>
                <path d="M8 14h.01"></path>
            </svg>
        ),
        Layout: () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="3" y1="9" x2="21" y2="9"></line>
                <line x1="9" y1="21" x2="9" y2="9"></line>
            </svg>
        ),
        Clock: () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        ),
        Settings: () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
        ),
        FileText: () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
        ),
        Plus: () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        ),
        Trash: () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
        ),
        Check: () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        ),
        ChevronRight: () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        ),
        ChevronLeft: () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        ),
        Upload: () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
        ),
        Download: () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        )
    };

    // ============================================
    // STEP DEFINITIONS
    // ============================================
    const STEPS = [
        { id: 1, title: 'Building Identification', icon: Icons.Building, description: 'Basic building information and location' },
        { id: 2, title: 'Building Configuration', icon: Icons.Layout, description: 'Zones, floors, and area breakdown' },
        { id: 3, title: 'Operating Schedules', icon: Icons.Clock, description: 'Occupancy and HVAC schedules' },
        { id: 4, title: 'Equipment Lists', icon: Icons.Settings, description: 'HVAC and electrical equipment inventory' },
        { id: 5, title: 'Utility Bills', icon: Icons.FileText, description: 'Historical energy consumption data' }
    ];

    // ============================================
    // STYLED COMPONENTS
    // ============================================
    const styles = {
        container: {
            maxWidth: '1200px',
            margin: '0 auto',
            padding: '20px',
            minHeight: '100vh'
        },
        header: {
            display: 'flex',
            alignItems: 'flex-start',
            gap: '20px',
            borderBottom: '3px solid #1a365d',
            paddingBottom: '20px',
            marginBottom: '30px',
            background: 'white',
            padding: '24px',
            borderRadius: '12px',
            boxShadow: '0 4px 20px rgba(0,0,0,0.08)'
        },
        logoBox: {
            width: '70px',
            height: '70px',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            flexShrink: 0
        },
        headerContent: {
            flexGrow: 1
        },
        title: {
            color: '#1a365d',
            margin: '0 0 5px 0',
            fontSize: '22pt',
            fontWeight: '600'
        },
        subtitle: {
            color: '#2c5282',
            fontSize: '12pt',
            margin: '0 0 12px 0'
        },
        badge: {
            display: 'inline-block',
            background: '#2E86AB',
            color: 'white',
            padding: '4px 14px',
            borderRadius: '20px',
            fontSize: '9pt',
            fontWeight: '600'
        },
        progressContainer: {
            background: 'white',
            borderRadius: '12px',
            padding: '24px',
            marginBottom: '24px',
            boxShadow: '0 2px 12px rgba(0,0,0,0.06)'
        },
        stepsRow: {
            display: 'flex',
            justifyContent: 'space-between',
            position: 'relative'
        },
        stepItem: (isActive, isCompleted) => ({
            display: 'flex',
            flexDirection: 'column',
            alignItems: 'center',
            flex: 1,
            position: 'relative',
            cursor: 'pointer',
            transition: 'all 0.3s ease'
        }),
        stepCircle: (isActive, isCompleted) => ({
            width: '48px',
            height: '48px',
            borderRadius: '50%',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            background: isCompleted ? '#276749' : isActive ? '#1a365d' : '#e2e8f0',
            color: isCompleted || isActive ? 'white' : '#718096',
            transition: 'all 0.3s ease',
            boxShadow: isActive ? '0 4px 12px rgba(26, 54, 93, 0.3)' : 'none',
            transform: isActive ? 'scale(1.1)' : 'scale(1)'
        }),
        stepLabel: (isActive, isCompleted) => ({
            marginTop: '10px',
            fontSize: '9pt',
            fontWeight: isActive ? '600' : '400',
            color: isActive ? '#1a365d' : isCompleted ? '#276749' : '#718096',
            textAlign: 'center',
            maxWidth: '100px'
        }),
        stepConnector: (isCompleted) => ({
            position: 'absolute',
            top: '24px',
            left: 'calc(50% + 30px)',
            width: 'calc(100% - 60px)',
            height: '3px',
            background: isCompleted ? '#276749' : '#e2e8f0',
            transition: 'background 0.3s ease'
        }),
        formCard: {
            background: 'white',
            borderRadius: '12px',
            padding: '32px',
            boxShadow: '0 4px 20px rgba(0,0,0,0.08)',
            marginBottom: '24px'
        },
        formSection: {
            marginBottom: '28px'
        },
        sectionTitle: {
            color: '#2c5282',
            fontSize: '13pt',
            fontWeight: '600',
            borderBottom: '2px solid #e2e8f0',
            paddingBottom: '10px',
            marginBottom: '20px',
            display: 'flex',
            alignItems: 'center',
            gap: '10px'
        },
        formGrid: {
            display: 'grid',
            gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))',
            gap: '20px'
        },
        formGroup: {
            display: 'flex',
            flexDirection: 'column',
            gap: '6px'
        },
        label: {
            fontSize: '10pt',
            fontWeight: '500',
            color: '#4a5568'
        },
        required: {
            color: '#c53030',
            marginLeft: '2px'
        },
        input: {
            padding: '12px 14px',
            border: '1px solid #e2e8f0',
            borderRadius: '8px',
            fontSize: '10pt',
            transition: 'all 0.2s ease',
            outline: 'none'
        },
        select: {
            padding: '12px 14px',
            border: '1px solid #e2e8f0',
            borderRadius: '8px',
            fontSize: '10pt',
            background: 'white',
            cursor: 'pointer',
            outline: 'none'
        },
        textarea: {
            padding: '12px 14px',
            border: '1px solid #e2e8f0',
            borderRadius: '8px',
            fontSize: '10pt',
            minHeight: '80px',
            resize: 'vertical',
            fontFamily: 'inherit',
            outline: 'none'
        },
        buttonRow: {
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            gap: '12px',
            marginTop: '20px',
            paddingTop: '20px',
            borderTop: '1px solid #e2e8f0'
        },
        button: {
            display: 'flex',
            alignItems: 'center',
            gap: '8px',
            padding: '12px 24px',
            borderRadius: '8px',
            fontSize: '10pt',
            fontWeight: '600',
            cursor: 'pointer',
            transition: 'all 0.2s ease',
            border: 'none'
        },
        primaryButton: {
            background: '#1a365d',
            color: 'white'
        },
        secondaryButton: {
            background: '#f7fafc',
            color: '#4a5568',
            border: '1px solid #e2e8f0'
        },
        successButton: {
            background: '#276749',
            color: 'white'
        },
        dangerButton: {
            background: '#fff5f5',
            color: '#c53030',
            border: '1px solid #feb2b2'
        },
        addButton: {
            background: '#ebf8ff',
            color: '#2b6cb0',
            border: '1px solid #90cdf4',
            padding: '10px 16px'
        },
        itemCard: {
            background: '#f7fafc',
            border: '1px solid #e2e8f0',
            borderRadius: '10px',
            padding: '20px',
            marginBottom: '16px',
            position: 'relative'
        },
        itemHeader: {
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            marginBottom: '16px'
        },
        itemTitle: {
            fontSize: '11pt',
            fontWeight: '600',
            color: '#2c5282'
        },
        deleteBtn: {
            background: 'transparent',
            border: 'none',
            color: '#c53030',
            cursor: 'pointer',
            padding: '6px',
            borderRadius: '6px',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            transition: 'background 0.2s ease'
        },
        fileUpload: {
            border: '2px dashed #e2e8f0',
            borderRadius: '10px',
            padding: '24px',
            textAlign: 'center',
            cursor: 'pointer',
            transition: 'all 0.2s ease',
            background: '#fafafa'
        },
        fileUploadActive: {
            borderColor: '#3182ce',
            background: '#ebf8ff'
        },
        summaryCard: {
            background: 'linear-gradient(135deg, #1a365d 0%, #2c5282 100%)',
            borderRadius: '12px',
            padding: '24px',
            color: 'white',
            marginBottom: '24px'
        },
        summaryGrid: {
            display: 'grid',
            gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))',
            gap: '16px',
            marginTop: '16px'
        },
        summaryItem: {
            background: 'rgba(255,255,255,0.1)',
            borderRadius: '8px',
            padding: '14px',
            textAlign: 'center'
        },
        summaryValue: {
            fontSize: '20pt',
            fontWeight: '700',
            marginBottom: '4px'
        },
        summaryLabel: {
            fontSize: '9pt',
            opacity: '0.8'
        },
        note: {
            background: '#ebf8ff',
            borderLeft: '4px solid #3182ce',
            padding: '12px 16px',
            marginTop: '16px',
            borderRadius: '0 8px 8px 0',
            fontSize: '10pt',
            color: '#2b6cb0'
        }
    };

    // ============================================
    // FORM COMPONENTS
    // ============================================
    const FormInput = ({ label, required, type = 'text', value, onChange, placeholder, ...props }) => (
        <div style={styles.formGroup}>
            <label style={styles.label}>
                {label}
                {required && <span style={styles.required}>*</span>}
            </label>
            <input 
                type={type}
                style={styles.input}
                value={value || ''}
                onChange={e => onChange(e.target.value)}
                placeholder={placeholder}
                onFocus={e => e.target.style.borderColor = '#3182ce'}
                onBlur={e => e.target.style.borderColor = '#e2e8f0'}
                {...props}
            />
        </div>
    );

    const FormSelect = ({ label, required, options, value, onChange, placeholder }) => (
        <div style={styles.formGroup}>
            <label style={styles.label}>
                {label}
                {required && <span style={styles.required}>*</span>}
            </label>
            <select 
                style={styles.select}
                value={value || ''}
                onChange={e => onChange(e.target.value)}
                onFocus={e => e.target.style.borderColor = '#3182ce'}
                onBlur={e => e.target.style.borderColor = '#e2e8f0'}
            >
                <option value="">{placeholder || `Select ${label}`}</option>
                {options.map(opt => (
                    <option key={opt} value={opt}>{opt}</option>
                ))}
            </select>
        </div>
    );

    const FormTextarea = ({ label, required, value, onChange, placeholder, rows = 3 }) => (
        <div style={styles.formGroup}>
            <label style={styles.label}>
                {label}
                {required && <span style={styles.required}>*</span>}
            </label>
            <textarea 
                style={styles.textarea}
                value={value || ''}
                onChange={e => onChange(e.target.value)}
                placeholder={placeholder}
                rows={rows}
                onFocus={e => e.target.style.borderColor = '#3182ce'}
                onBlur={e => e.target.style.borderColor = '#e2e8f0'}
            />
        </div>
    );

    const FileUploadZone = ({ label, files, onFilesChange }) => {
        const [isDragging, setIsDragging] = useState(false);

        const handleDrop = (e) => {
            e.preventDefault();
            setIsDragging(false);
            const droppedFiles = Array.from(e.dataTransfer.files);
            onFilesChange([...files, ...droppedFiles.map(f => f.name)]);
        };

        return (
            <div style={styles.formGroup}>
                <label style={styles.label}>{label}</label>
                <div 
                    style={{...styles.fileUpload, ...(isDragging ? styles.fileUploadActive : {})}}
                    onDragOver={(e) => { e.preventDefault(); setIsDragging(true); }}
                    onDragLeave={() => setIsDragging(false)}
                    onDrop={handleDrop}
                    onClick={() => document.getElementById('file-input-' + label.replace(/\s/g, '')).click()}
                >
                    <input 
                        type="file" 
                        id={'file-input-' + label.replace(/\s/g, '')}
                        multiple 
                        style={{ display: 'none' }}
                        onChange={(e) => {
                            const newFiles = Array.from(e.target.files).map(f => f.name);
                            onFilesChange([...files, ...newFiles]);
                        }}
                    />
                    <div style={{ color: '#3182ce', marginBottom: '8px' }}><Icons.Upload /></div>
                    <p style={{ color: '#718096', fontSize: '10pt', margin: 0 }}>
                        Drag & drop files here, or <span style={{ color: '#3182ce', fontWeight: '500' }}>browse</span>
                    </p>
                    {files.length > 0 && (
                        <div style={{ marginTop: '12px', textAlign: 'left' }}>
                            {files.map((f, i) => (
                                <div key={i} style={{ 
                                    display: 'inline-flex', 
                                    alignItems: 'center', 
                                    background: 'white', 
                                    padding: '4px 10px', 
                                    borderRadius: '4px', 
                                    margin: '4px',
                                    fontSize: '9pt',
                                    border: '1px solid #e2e8f0'
                                }}>
                                    <Icons.FileText />
                                    <span style={{ marginLeft: '6px' }}>{f}</span>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            </div>
        );
    };

    // ============================================
    // STEP CONTENT COMPONENTS
    // ============================================

    // Step 1: Building Identification
    const Step1BuildingIdentification = ({ data, onChange }) => {
        const updateField = (field, value) => {
            onChange({ ...data, [field]: value });
        };

        return (
            <div className="fade-in">
                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>
                        <Icons.Building /> Basic Information
                    </h3>
                    <div style={styles.formGrid}>
                        <FormInput 
                            label="Project ID" 
                            required 
                            value={data.projectId}
                            onChange={v => updateField('projectId', v)}
                            placeholder="e.g., CNM-25-035-MNG"
                        />
                        <FormInput 
                            label="Building Name" 
                            required 
                            value={data.buildingName}
                            onChange={v => updateField('buildingName', v)}
                            placeholder="e.g., M&G Shanghai HQ"
                        />
                        <FormInput 
                            label="Project Name" 
                            required 
                            value={data.projectName}
                            onChange={v => updateField('projectName', v)}
                            placeholder="e.g., M&G HQ AIoT Controls"
                        />
                        <FormSelect 
                            label="Client" 
                            required 
                            options={SAMPLE_CLIENTS}
                            value={data.client}
                            onChange={v => updateField('client', v)}
                        />
                    </div>
                </div>

                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>Location Details</h3>
                    <div style={styles.formGrid}>
                        <FormTextarea 
                            label="Full Address" 
                            required 
                            value={data.address}
                            onChange={v => updateField('address', v)}
                            placeholder="Building street address"
                        />
                        <FormSelect 
                            label="City" 
                            required 
                            options={DATA_OPTIONS.cities}
                            value={data.city}
                            onChange={v => updateField('city', v)}
                        />
                        <FormSelect 
                            label="Region" 
                            required 
                            options={DATA_OPTIONS.regions}
                            value={data.region}
                            onChange={v => updateField('region', v)}
                        />
                    </div>
                </div>

                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>Building Classification</h3>
                    <div style={styles.formGrid}>
                        <FormSelect 
                            label="Building Type" 
                            required 
                            options={DATA_OPTIONS.buildingTypes}
                            value={data.buildingType}
                            onChange={v => updateField('buildingType', v)}
                        />
                        <FormSelect 
                            label="Thermal Source" 
                            required 
                            options={DATA_OPTIONS.thermalSources}
                            value={data.thermalSource}
                            onChange={v => updateField('thermalSource', v)}
                        />
                    </div>
                </div>

                <div style={styles.note}>
                    <strong>Tip:</strong> The Project ID follows the format CNM-YY-NNN-CLIENT-B# for unique building identification across all Gaiamesh projects.
                </div>
            </div>
        );
    };

    // Step 2: Building Configuration
    const Step2BuildingConfiguration = ({ data, onChange }) => {
        const addZone = () => {
            const zones = data.zones || [];
            onChange({
                ...data,
                zones: [...zones, { id: Date.now(), name: '', floors: '', area: '', useType: '' }]
            });
        };

        const updateZone = (index, field, value) => {
            const zones = [...(data.zones || [])];
            zones[index] = { ...zones[index], [field]: value };
            onChange({ ...data, zones });
        };

        const removeZone = (index) => {
            const zones = data.zones.filter((_, i) => i !== index);
            onChange({ ...data, zones });
        };

        const zones = data.zones || [{ id: 1, name: '', floors: '', area: '', useType: '' }];

        return (
            <div className="fade-in">
                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>
                        <Icons.Layout /> Zone Configuration
                    </h3>
                    <p style={{ color: '#718096', fontSize: '10pt', marginBottom: '20px' }}>
                        Define building zones, floors, and gross floor area (GFA) breakdown.
                    </p>

                    {zones.map((zone, index) => (
                        <div key={zone.id} style={styles.itemCard} className="slide-in">
                            <div style={styles.itemHeader}>
                                <span style={styles.itemTitle}>Zone {index + 1}</span>
                                {zones.length > 1 && (
                                    <button 
                                        style={styles.deleteBtn}
                                        onClick={() => removeZone(index)}
                                        onMouseOver={e => e.target.style.background = '#fff5f5'}
                                        onMouseOut={e => e.target.style.background = 'transparent'}
                                    >
                                        <Icons.Trash />
                                    </button>
                                )}
                            </div>
                            <div style={styles.formGrid}>
                                <FormInput 
                                    label="Zone Name" 
                                    required
                                    value={zone.name}
                                    onChange={v => updateZone(index, 'name', v)}
                                    placeholder="e.g., Tower A, North Wing"
                                />
                                <FormInput 
                                    label="Number of Floors" 
                                    type="number"
                                    required
                                    value={zone.floors}
                                    onChange={v => updateZone(index, 'floors', v)}
                                    placeholder="e.g., 21"
                                />
                                <FormInput 
                                    label="Gross Floor Area (m²)" 
                                    type="number"
                                    required
                                    value={zone.area}
                                    onChange={v => updateZone(index, 'area', v)}
                                    placeholder="e.g., 31122"
                                />
                                <FormSelect 
                                    label="Primary Use Type" 
                                    required
                                    options={DATA_OPTIONS.useTypes}
                                    value={zone.useType}
                                    onChange={v => updateZone(index, 'useType', v)}
                                />
                            </div>
                        </div>
                    ))}

                    <button 
                        style={{...styles.button, ...styles.addButton}}
                        onClick={addZone}
                    >
                        <Icons.Plus /> Add Another Zone
                    </button>
                </div>

                {zones.length > 0 && zones[0].area && (
                    <div style={styles.summaryCard}>
                        <h4 style={{ margin: 0, fontSize: '12pt' }}>Configuration Summary</h4>
                        <div style={styles.summaryGrid}>
                            <div style={styles.summaryItem}>
                                <div style={styles.summaryValue}>{zones.length}</div>
                                <div style={styles.summaryLabel}>Total Zones</div>
                            </div>
                            <div style={styles.summaryItem}>
                                <div style={styles.summaryValue}>
                                    {zones.reduce((sum, z) => sum + (parseInt(z.floors) || 0), 0)}
                                </div>
                                <div style={styles.summaryLabel}>Total Floors</div>
                            </div>
                            <div style={styles.summaryItem}>
                                <div style={styles.summaryValue}>
                                    {zones.reduce((sum, z) => sum + (parseInt(z.area) || 0), 0).toLocaleString()}
                                </div>
                                <div style={styles.summaryLabel}>Total GFA (m²)</div>
                            </div>
                        </div>
                    </div>
                )}
            </div>
        );
    };

    // Step 3: Operating Schedules
    const Step3OperatingSchedules = ({ data, onChange }) => {
        const addSchedule = () => {
            const schedules = data.schedules || [];
            onChange({
                ...data,
                schedules: [...schedules, { 
                    id: Date.now(), 
                    name: '', 
                    zoneName: '',
                    weekdayStart: '',
                    weekdayEnd: '',
                    weekendStart: '',
                    weekendEnd: '',
                    holidaySchedule: '',
                    setpoint: ''
                }]
            });
        };

        const updateSchedule = (index, field, value) => {
            const schedules = [...(data.schedules || [])];
            schedules[index] = { ...schedules[index], [field]: value };
            onChange({ ...data, schedules });
        };

        const removeSchedule = (index) => {
            const schedules = data.schedules.filter((_, i) => i !== index);
            onChange({ ...data, schedules });
        };

        const schedules = data.schedules || [{ id: 1 }];
        const timeOptions = Array.from({length: 24}, (_, i) => 
            `${i.toString().padStart(2, '0')}:00`
        );

        return (
            <div className="fade-in">
                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>
                        <Icons.Clock /> Operating Schedules
                    </h3>
                    <p style={{ color: '#718096', fontSize: '10pt', marginBottom: '20px' }}>
                        Define HVAC operating hours for each zone. Off-hours represent periods when HVAC can be reduced or shut down.
                    </p>

                    {schedules.map((schedule, index) => (
                        <div key={schedule.id} style={styles.itemCard} className="slide-in">
                            <div style={styles.itemHeader}>
                                <span style={styles.itemTitle}>Schedule {index + 1}</span>
                                {schedules.length > 1 && (
                                    <button 
                                        style={styles.deleteBtn}
                                        onClick={() => removeSchedule(index)}
                                    >
                                        <Icons.Trash />
                                    </button>
                                )}
                            </div>
                            <div style={styles.formGrid}>
                                <FormInput 
                                    label="Schedule Name" 
                                    value={schedule.name}
                                    onChange={v => updateSchedule(index, 'name', v)}
                                    placeholder="e.g., Standard Office Hours"
                                />
                                <FormInput 
                                    label="Zone/Area Name" 
                                    value={schedule.zoneName}
                                    onChange={v => updateSchedule(index, 'zoneName', v)}
                                    placeholder="e.g., Building 1"
                                />
                            </div>
                            
                            <div style={{ marginTop: '16px' }}>
                                <label style={{ ...styles.label, marginBottom: '12px', display: 'block' }}>
                                    Weekday Off-Hours (HVAC Reduced)
                                </label>
                                <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                                    <FormSelect 
                                        label=""
                                        options={timeOptions}
                                        value={schedule.weekdayStart}
                                        onChange={v => updateSchedule(index, 'weekdayStart', v)}
                                        placeholder="Start Time"
                                    />
                                    <span style={{ color: '#718096' }}>to</span>
                                    <FormSelect 
                                        label=""
                                        options={timeOptions}
                                        value={schedule.weekdayEnd}
                                        onChange={v => updateSchedule(index, 'weekdayEnd', v)}
                                        placeholder="End Time"
                                    />
                                </div>
                            </div>

                            <div style={{ marginTop: '16px' }}>
                                <label style={{ ...styles.label, marginBottom: '12px', display: 'block' }}>
                                    Weekend Off-Hours (HVAC Reduced)
                                </label>
                                <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                                    <FormSelect 
                                        label=""
                                        options={timeOptions}
                                        value={schedule.weekendStart}
                                        onChange={v => updateSchedule(index, 'weekendStart', v)}
                                        placeholder="Start Time"
                                    />
                                    <span style={{ color: '#718096' }}>to</span>
                                    <FormSelect 
                                        label=""
                                        options={timeOptions}
                                        value={schedule.weekendEnd}
                                        onChange={v => updateSchedule(index, 'weekendEnd', v)}
                                        placeholder="End Time"
                                    />
                                </div>
                            </div>

                            <div style={{ ...styles.formGrid, marginTop: '16px' }}>
                                <FormSelect 
                                    label="Holiday Schedule" 
                                    options={DATA_OPTIONS.holidaySchedules}
                                    value={schedule.holidaySchedule}
                                    onChange={v => updateSchedule(index, 'holidaySchedule', v)}
                                />
                                <FormInput 
                                    label="HVAC Setpoint (°C)" 
                                    type="number"
                                    value={schedule.setpoint}
                                    onChange={v => updateSchedule(index, 'setpoint', v)}
                                    placeholder="e.g., 24"
                                />
                            </div>
                        </div>
                    ))}

                    <button 
                        style={{...styles.button, ...styles.addButton}}
                        onClick={addSchedule}
                    >
                        <Icons.Plus /> Add Another Schedule
                    </button>
                </div>

                <div style={styles.note}>
                    <strong>Note:</strong> Off-hours represent periods when HVAC systems can be powered down or run in setback mode. 
                    This data is critical for calculating potential savings from schedule optimization.
                </div>
            </div>
        );
    };

    // Step 4: Equipment Lists
    const Step4EquipmentLists = ({ data, onChange }) => {
        const addEquipment = () => {
            const equipment = data.equipment || [];
            onChange({
                ...data,
                equipment: [...equipment, { 
                    id: Date.now(), 
                    type: '',
                    count: '',
                    capacity: '',
                    brand: '',
                    model: '',
                    yearInstalled: ''
                }]
            });
        };

        const updateEquipment = (index, field, value) => {
            const equipment = [...(data.equipment || [])];
            equipment[index] = { ...equipment[index], [field]: value };
            onChange({ ...data, equipment });
        };

        const removeEquipment = (index) => {
            const equipment = data.equipment.filter((_, i) => i !== index);
            onChange({ ...data, equipment });
        };

        const updateFiles = (files) => {
            onChange({ ...data, assetFiles: files });
        };

        const equipment = data.equipment || [{ id: 1 }];

        return (
            <div className="fade-in">
                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>
                        <Icons.Settings /> Equipment Inventory
                    </h3>
                    <p style={{ color: '#718096', fontSize: '10pt', marginBottom: '20px' }}>
                        List major HVAC and electrical equipment. This helps estimate energy consumption breakdown and identify optimization opportunities.
                    </p>

                    {equipment.map((item, index) => (
                        <div key={item.id} style={styles.itemCard} className="slide-in">
                            <div style={styles.itemHeader}>
                                <span style={styles.itemTitle}>Equipment {index + 1}</span>
                                {equipment.length > 1 && (
                                    <button 
                                        style={styles.deleteBtn}
                                        onClick={() => removeEquipment(index)}
                                    >
                                        <Icons.Trash />
                                    </button>
                                )}
                            </div>
                            <div style={styles.formGrid}>
                                <FormSelect 
                                    label="Equipment Type" 
                                    required
                                    options={DATA_OPTIONS.equipmentTypes}
                                    value={item.type}
                                    onChange={v => updateEquipment(index, 'type', v)}
                                />
                                <FormInput 
                                    label="Quantity" 
                                    type="number"
                                    required
                                    value={item.count}
                                    onChange={v => updateEquipment(index, 'count', v)}
                                    placeholder="e.g., 4"
                                />
                                <FormInput 
                                    label="Capacity (kW or RT)" 
                                    value={item.capacity}
                                    onChange={v => updateEquipment(index, 'capacity', v)}
                                    placeholder="e.g., 500 kW"
                                />
                                <FormInput 
                                    label="Brand" 
                                    value={item.brand}
                                    onChange={v => updateEquipment(index, 'brand', v)}
                                    placeholder="e.g., Daikin, Carrier"
                                />
                                <FormInput 
                                    label="Model" 
                                    value={item.model}
                                    onChange={v => updateEquipment(index, 'model', v)}
                                    placeholder="e.g., RXYQ-P"
                                />
                                <FormInput 
                                    label="Year Installed" 
                                    type="number"
                                    value={item.yearInstalled}
                                    onChange={v => updateEquipment(index, 'yearInstalled', v)}
                                    placeholder="e.g., 2018"
                                />
                            </div>
                        </div>
                    ))}

                    <button 
                        style={{...styles.button, ...styles.addButton}}
                        onClick={addEquipment}
                    >
                        <Icons.Plus /> Add Equipment
                    </button>
                </div>

                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>Asset Documentation</h3>
                    <FileUploadZone 
                        label="Equipment Lists & Asset Files"
                        files={data.assetFiles || []}
                        onFilesChange={updateFiles}
                    />
                    <FormTextarea 
                        label="Additional Notes" 
                        value={data.equipmentNotes}
                        onChange={v => onChange({ ...data, equipmentNotes: v })}
                        placeholder="Any additional information about equipment, recent upgrades, known issues, etc."
                    />
                </div>
            </div>
        );
    };

    // Step 5: Utility Bills
    const Step5UtilityBills = ({ data, onChange }) => {
        const addBill = () => {
            const bills = data.bills || [];
            onChange({
                ...data,
                bills: [...bills, { 
                    id: Date.now(), 
                    utilityType: '',
                    periodStart: '',
                    periodEnd: '',
                    consumption: '',
                    cost: '',
                    unit: ''
                }]
            });
        };

        const updateBill = (index, field, value) => {
            const bills = [...(data.bills || [])];
            bills[index] = { ...bills[index], [field]: value };
            onChange({ ...data, bills });
        };

        const removeBill = (index) => {
            const bills = data.bills.filter((_, i) => i !== index);
            onChange({ ...data, bills });
        };

        const updateFiles = (files) => {
            onChange({ ...data, billFiles: files });
        };

        const bills = data.bills || [{ id: 1 }];

        return (
            <div className="fade-in">
                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>
                        <Icons.FileText /> Utility Bill Records
                    </h3>
                    <p style={{ color: '#718096', fontSize: '10pt', marginBottom: '20px' }}>
                        Provide 12-24 months of utility bill data for accurate baseline modeling and savings projections.
                    </p>

                    <FileUploadZone 
                        label="Upload Utility Bills (Excel, CSV, PDF)"
                        files={data.billFiles || []}
                        onFilesChange={updateFiles}
                    />
                </div>

                <div style={styles.formSection}>
                    <h3 style={styles.sectionTitle}>Manual Entry (Optional)</h3>
                    <p style={{ color: '#718096', fontSize: '10pt', marginBottom: '20px' }}>
                        Alternatively, enter summary data manually for each billing period.
                    </p>

                    {bills.map((bill, index) => (
                        <div key={bill.id} style={styles.itemCard} className="slide-in">
                            <div style={styles.itemHeader}>
                                <span style={styles.itemTitle}>Bill Record {index + 1}</span>
                                {bills.length > 1 && (
                                    <button 
                                        style={styles.deleteBtn}
                                        onClick={() => removeBill(index)}
                                    >
                                        <Icons.Trash />
                                    </button>
                                )}
                            </div>
                            <div style={styles.formGrid}>
                                <FormSelect 
                                    label="Utility Type" 
                                    required
                                    options={DATA_OPTIONS.utilityTypes}
                                    value={bill.utilityType}
                                    onChange={v => updateBill(index, 'utilityType', v)}
                                />
                                <FormInput 
                                    label="Period Start" 
                                    type="date"
                                    value={bill.periodStart}
                                    onChange={v => updateBill(index, 'periodStart', v)}
                                />
                                <FormInput 
                                    label="Period End" 
                                    type="date"
                                    value={bill.periodEnd}
                                    onChange={v => updateBill(index, 'periodEnd', v)}
                                />
                                <FormInput 
                                    label="Consumption" 
                                    type="number"
                                    value={bill.consumption}
                                    onChange={v => updateBill(index, 'consumption', v)}
                                    placeholder="e.g., 125000"
                                />
                                <FormInput 
                                    label="Unit" 
                                    value={bill.unit}
                                    onChange={v => updateBill(index, 'unit', v)}
                                    placeholder="e.g., kWh, m³"
                                />
                                <FormInput 
                                    label="Cost (¥ or $)" 
                                    type="number"
                                    value={bill.cost}
                                    onChange={v => updateBill(index, 'cost', v)}
                                    placeholder="e.g., 95000"
                                />
                            </div>
                        </div>
                    ))}

                    <button 
                        style={{...styles.button, ...styles.addButton}}
                        onClick={addBill}
                    >
                        <Icons.Plus /> Add Bill Record
                    </button>
                </div>

                <div style={styles.note}>
                    <strong>Data Requirements:</strong> Minimum 12 months of utility data recommended for accurate baseline modeling. 
                    Include all utility types (electricity, gas, district cooling/heating) if available.
                </div>
            </div>
        );
    };

    // ============================================
    // REVIEW SUMMARY COMPONENT
    // ============================================
    const ReviewSummary = ({ formData }) => {
        const step1 = formData.step1 || {};
        const step2 = formData.step2 || {};
        const step3 = formData.step3 || {};
        const step4 = formData.step4 || {};
        const step5 = formData.step5 || {};

        const zones = step2.zones || [];
        const schedules = step3.schedules || [];
        const equipment = step4.equipment || [];
        const bills = step5.bills || [];

        const totalArea = zones.reduce((sum, z) => sum + (parseInt(z.area) || 0), 0);
        const totalFloors = zones.reduce((sum, z) => sum + (parseInt(z.floors) || 0), 0);
        const totalEquipment = equipment.reduce((sum, e) => sum + (parseInt(e.count) || 0), 0);

        return (
            <div className="fade-in">
                <div style={styles.summaryCard}>
                    <h3 style={{ margin: '0 0 8px 0', fontSize: '14pt' }}>Health Check Data Summary</h3>
                    <p style={{ margin: 0, opacity: 0.8, fontSize: '10pt' }}>
                        {step1.projectName || 'Unnamed Project'} • {step1.client || 'No Client'}
                    </p>
                    <div style={styles.summaryGrid}>
                        <div style={styles.summaryItem}>
                            <div style={styles.summaryValue}>{zones.length}</div>
                            <div style={styles.summaryLabel}>Zones</div>
                        </div>
                        <div style={styles.summaryItem}>
                            <div style={styles.summaryValue}>{totalFloors}</div>
                            <div style={styles.summaryLabel}>Floors</div>
                        </div>
                        <div style={styles.summaryItem}>
                            <div style={styles.summaryValue}>{totalArea.toLocaleString()}</div>
                            <div style={styles.summaryLabel}>GFA (m²)</div>
                        </div>
                        <div style={styles.summaryItem}>
                            <div style={styles.summaryValue}>{totalEquipment}</div>
                            <div style={styles.summaryLabel}>Equipment</div>
                        </div>
                        <div style={styles.summaryItem}>
                            <div style={styles.summaryValue}>{schedules.length}</div>
                            <div style={styles.summaryLabel}>Schedules</div>
                        </div>
                        <div style={styles.summaryItem}>
                            <div style={styles.summaryValue}>{bills.length + (step5.billFiles?.length || 0)}</div>
                            <div style={styles.summaryLabel}>Bill Records</div>
                        </div>
                    </div>
                </div>

                <div style={styles.formCard}>
                    <h3 style={styles.sectionTitle}>
                        <Icons.Building /> Building Identification
                    </h3>
                    <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '10pt' }}>
                        <tbody>
                            {[
                                ['Project ID', step1.projectId],
                                ['Building Name', step1.buildingName],
                                ['Client', step1.client],
                                ['Location', `${step1.city}, ${step1.region}`],
                                ['Building Type', step1.buildingType],
                                ['Thermal Source', step1.thermalSource]
                            ].map(([label, value]) => (
                                <tr key={label}>
                                    <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0', fontWeight: '500', width: '40%' }}>{label}</td>
                                    <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0', color: value ? '#2d3748' : '#a0aec0' }}>{value || '—'}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>

                {zones.length > 0 && zones[0].name && (
                    <div style={styles.formCard}>
                        <h3 style={styles.sectionTitle}>
                            <Icons.Layout /> Zones Configuration
                        </h3>
                        <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '10pt' }}>
                            <thead>
                                <tr style={{ background: '#f7fafc' }}>
                                    <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '2px solid #e2e8f0' }}>Zone</th>
                                    <th style={{ padding: '10px 12px', textAlign: 'center', borderBottom: '2px solid #e2e8f0' }}>Floors</th>
                                    <th style={{ padding: '10px 12px', textAlign: 'right', borderBottom: '2px solid #e2e8f0' }}>Area (m²)</th>
                                    <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '2px solid #e2e8f0' }}>Use Type</th>
                                </tr>
                            </thead>
                            <tbody>
                                {zones.map((zone, i) => (
                                    <tr key={i}>
                                        <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0' }}>{zone.name}</td>
                                        <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0', textAlign: 'center' }}>{zone.floors}</td>
                                        <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0', textAlign: 'right' }}>{parseInt(zone.area).toLocaleString()}</td>
                                        <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0' }}>{zone.useType}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                )}

                {equipment.length > 0 && equipment[0].type && (
                    <div style={styles.formCard}>
                        <h3 style={styles.sectionTitle}>
                            <Icons.Settings /> Equipment Summary
                        </h3>
                        <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '10pt' }}>
                            <thead>
                                <tr style={{ background: '#f7fafc' }}>
                                    <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '2px solid #e2e8f0' }}>Type</th>
                                    <th style={{ padding: '10px 12px', textAlign: 'center', borderBottom: '2px solid #e2e8f0' }}>Qty</th>
                                    <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '2px solid #e2e8f0' }}>Capacity</th>
                                    <th style={{ padding: '10px 12px', textAlign: 'left', borderBottom: '2px solid #e2e8f0' }}>Brand/Model</th>
                                </tr>
                            </thead>
                            <tbody>
                                {equipment.filter(e => e.type).map((item, i) => (
                                    <tr key={i}>
                                        <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0' }}>{item.type}</td>
                                        <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0', textAlign: 'center' }}>{item.count}</td>
                                        <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0' }}>{item.capacity || '—'}</td>
                                        <td style={{ padding: '8px 12px', borderBottom: '1px solid #e2e8f0' }}>{item.brand} {item.model}</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                )}

                <div style={styles.note}>
                    <strong>Ready to Submit:</strong> Review the information above. Click "Submit Health Check Data" to generate the analysis report.
                </div>
            </div>
        );
    };

    // ============================================
    // MAIN APP COMPONENT
    // ============================================
    const HealthCheckApp = () => {
        const [currentStep, setCurrentStep] = useState(1);
        const [formData, setFormData] = useState({
            step1: {},
            step2: { zones: [{ id: 1 }] },
            step3: { schedules: [{ id: 1 }] },
            step4: { equipment: [{ id: 1 }], assetFiles: [] },
            step5: { bills: [{ id: 1 }], billFiles: [] }
        });
        const [showReview, setShowReview] = useState(false);

        const updateStepData = (step, data) => {
            setFormData(prev => ({
                ...prev,
                [`step${step}`]: data
            }));
        };

        const nextStep = () => {
            if (currentStep < 5) {
                setCurrentStep(currentStep + 1);
            } else {
                setShowReview(true);
            }
        };

        const prevStep = () => {
            if (showReview) {
                setShowReview(false);
            } else if (currentStep > 1) {
                setCurrentStep(currentStep - 1);
            }
        };

        const handleSubmit = () => {
            // Generate JSON output
            const output = JSON.stringify(formData, null, 2);
            const blob = new Blob([output], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `health-check-data-${formData.step1.projectId || 'draft'}.json`;
            a.click();
            URL.revokeObjectURL(url);
            alert('Health Check data exported successfully!');
        };

        const renderStepContent = () => {
            if (showReview) {
                return <ReviewSummary formData={formData} />;
            }

            switch (currentStep) {
                case 1:
                    return <Step1BuildingIdentification data={formData.step1} onChange={d => updateStepData(1, d)} />;
                case 2:
                    return <Step2BuildingConfiguration data={formData.step2} onChange={d => updateStepData(2, d)} />;
                case 3:
                    return <Step3OperatingSchedules data={formData.step3} onChange={d => updateStepData(3, d)} />;
                case 4:
                    return <Step4EquipmentLists data={formData.step4} onChange={d => updateStepData(4, d)} />;
                case 5:
                    return <Step5UtilityBills data={formData.step5} onChange={d => updateStepData(5, d)} />;
                default:
                    return null;
            }
        };

        return (
            <div style={styles.container}>

                {/* Progress Steps */}
                <div style={styles.progressContainer}>
                    <div style={styles.stepsRow}>
                        {STEPS.map((step, index) => {
                            const isActive = !showReview && currentStep === step.id;
                            const isCompleted = showReview || currentStep > step.id;
                            const IconComponent = step.icon;

                            return (
                                <div 
                                    key={step.id} 
                                    style={styles.stepItem(isActive, isCompleted)}
                                    onClick={() => {
                                        if (!showReview && step.id <= currentStep) {
                                            setCurrentStep(step.id);
                                        }
                                    }}
                                >
                                    {index < STEPS.length - 1 && (
                                        <div style={styles.stepConnector(isCompleted)} />
                                    )}
                                    <div style={styles.stepCircle(isActive, isCompleted)}>
                                        {isCompleted && !isActive ? <Icons.Check /> : <IconComponent />}
                                    </div>
                                    <span style={styles.stepLabel(isActive, isCompleted)}>
                                        {step.title}
                                    </span>
                                </div>
                            );
                        })}
                    </div>
                </div>

                {/* Form Content */}
                <div style={styles.formCard}>
                    {!showReview && (
                        <div style={{ marginBottom: '24px' }}>
                            <h2 style={{ color: '#1a365d', margin: '0 0 8px 0', fontSize: '16pt' }}>
                                {showReview ? 'Review & Submit' : STEPS[currentStep - 1].title}
                            </h2>
                            <p style={{ color: '#718096', margin: 0, fontSize: '10pt' }}>
                                {showReview ? 'Review all entered data before submission' : STEPS[currentStep - 1].description}
                            </p>
                        </div>
                    )}

                    {renderStepContent()}

                    <div style={styles.buttonRow}>
                        <button 
                            style={{
                                ...styles.button, 
                                ...styles.secondaryButton,
                                opacity: currentStep === 1 && !showReview ? 0.5 : 1,
                                cursor: currentStep === 1 && !showReview ? 'not-allowed' : 'pointer'
                            }}
                            onClick={prevStep}
                            disabled={currentStep === 1 && !showReview}
                        >
                            <Icons.ChevronLeft /> Back
                        </button>
                        
                        <div style={{ display: 'flex', gap: '12px' }}>
                            {showReview ? (
                                <>
                                    <button 
                                        style={{...styles.button, ...styles.secondaryButton}}
                                        onClick={() => setShowReview(false)}
                                    >
                                        Edit Data
                                    </button>
                                    <button 
                                        style={{...styles.button, ...styles.successButton}}
                                        onClick={handleSubmit}
                                    >
                                        <Icons.Download /> Export JSON
                                    </button>
                                </>
                            ) : (
                                <button 
                                    style={{...styles.button, ...styles.primaryButton}}
                                    onClick={nextStep}
                                >
                                    {currentStep === 5 ? 'Review Data' : 'Continue'} <Icons.ChevronRight />
                                </button>
                            )}
                        </div>
                    </div>
                </div>

                {/* Footer */}
                <div style={{ textAlign: 'center', color: '#718096', fontSize: '9pt', marginTop: '20px' }}>
                    Gaiamesh™ Health Check Data Collection System • v1.0 • {new Date().toLocaleDateString()}
                </div>
            </div>
        );
    };

    // Render the app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<HealthCheckApp />);
    </script>
</body>
</html>
